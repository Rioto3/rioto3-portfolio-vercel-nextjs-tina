# TinaCMS GitHub ブランチ戦略ガイド

## ブランチ構造
```
main (ベースコード/開発基点)
 │
 ├── production (公開サイト用ブランチ)
 │     │
 │     └── drafts (コンテンツ編集専用ブランチ - content/フォルダのみ)
 │
 │
 └── feature/* (機能開発用ブランチ)
      └── 完成後 → main にマージ
```

## ブランチの役割と権限
| ブランチ | 目的 | 操作可能なパス | 権限 | マージ方法 |
|---------|------|--------------|------|----------|
| `main` | 開発基点・コードベース | すべて | 開発チーム (PR経由) | スカッシュマージ |
| `production` | 公開サイト用 | `/content/` のみ直接編集可 | 管理者 (PR経由) | Fast-forward only |
| `drafts` | コンテンツ編集用 | `/content/` のみ | コンテンツ編集者 | 通常マージ |
| `feature/*` | 機能開発用 | すべて | 開発チーム | - |

## ブランチ保護ルール
### main
- 作成・削除禁止
- PRレビュー承認必須（1名）
- ステータスチェック必須
- スカッシュマージのみ許可
- 強制プッシュ禁止

### production
- 作成・削除禁止
- 直接更新禁止（PRのみ）
- Fast-forward マージのみ許可
- 強制プッシュ禁止

### drafts
- 作成・削除禁止
- `/content/` 以外の更新禁止
- 強制プッシュ禁止

## ワークフロー
### コンテンツ更新フロー
1. `drafts` ブランチでコンテンツ編集
2. プレビュー環境で確認
3. `production` へのPRを作成・レビュー
4. Fast-forward マージで公開

### 機能開発フロー
1. `main` から `feature/xxx` ブランチを作成
2. 開発・テスト
3. `main` へのPRを作成・レビュー
4. スカッシュマージで `main` へマージ
5. 必要に応じて `main` から `production` へFast-forwardマージで反映

### コードとコンテンツ同期フロー
1. `main` の変更を定期的に `production` へFast-forwardマージ
2. その後 `production` から `drafts` へマージして最新コードを反映
